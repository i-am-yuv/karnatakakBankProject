<p-toast></p-toast>
<div style="align-items: start;  width:-webkit-fill-available;">

    <!-- For Middle Button Code -->
    <div class="flex" style="align-items: start; justify-content: space-between;">
        <div class="flex"
            style="margin-top: 30px; align-items: center; justify-content: center;width:-webkit-fill-available; ">
            <div
                style="width: 247px; height: 52px; display: flex; border-radius: 6px;
         align-items: center; justify-content: center; font-size: 20px;  color:#FFFFFF;background-color: #92278F;border-radius: 6px;font-weight: 600;">
                <div>
                    Employee Attendence
                </div>
            </div>
        </div>

    </div>

    <!-- Result View Table -->
    <div class="flex border-1 p-3" style="flex-wrap: wrap; justify-content: space-between; align-items: center;
     margin-top: 32px; margin-bottom: 32px; margin-left: 16px; margin-right: 16px;
     background-color: #FFFFFF; border-radius: 8px; border-width: 1px;border-color: #D1D1D1; ">

        <div class="col-12">
            <div class="col-12">

                <div class="flex justify-content-start mb-3 gap-4">

                    <div style="font-size: 18px; font-weight: 400; color: #101828;border-radius: 9px;">
                        <span class="p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" class=""
                                style="background: #FFFFFF;width: 532px;border: 1px solid #101828;"
                                (input)="applyFilterGlobal($event, 'contains')" placeholder="Search" />
                        </span>

                    </div>

                    <!-- <div style="font-size: 18px; font-weight: 400; color: #101828; border-radius: 9px;">
                        <img src="assets/calendar_icon.png" (click)="showCalendar = !showCalendar"
                            style="cursor: pointer; margin-right: 224px; width: 87px; height: 40px;  border-radius: 8px;">

                        <p-calendar *ngIf="showCalendar" appendTo="body"></p-calendar>

                        
                    </div> -->
                    <div style="font-size: 18px; font-weight: 400; color: #101828; border-radius: 9px;">
                        <!-- <img src="assets/calendar_icon.png" (click)="showCalendar = !showCalendar"
                            style="cursor: pointer; margin-right: 224px; width: 87px; height: 40px;  border-radius: 8px;"> -->

                            <p-calendar [showIcon]="true" inputId="buttondisplay" [showOnFocus]="false" [(ngModel)]="selectedDate"></p-calendar>

                    </div>
                </div>

                <!-- Table Starts From here -->
                <div>
                    <p-table #dt [columns]="cols" [value]="users" [scrollable]="true"
                        [globalFilterFields]="['userName','employeeId','status', 'role']">
                        <ng-template pTemplate="header">
                            <tr>
                                <th style="background-color: #92278F;color: #FFFFFF;font-weight: 700;">Employee Name
                                </th>
                                <th style="background-color: #92278F;color: #FFFFFF;font-weight: 700;"> Employee Id
                                </th>
                                <th style="background-color: #92278F;color: #FFFFFF;font-weight: 700;">Status</th>

                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-record let-rowIndex="rowIndex">
                            <tr [ngClass]="{ 'oddRow':rowIndex % 2 === 0}">
                                <td style="color: #6D6D6D;">

                                    <div class="flex justify-content-start align-items-center gap-2">
                                        <div style="width: 40px;height: 40px; background-color:#F4EBFF;color: #000000;border-radius: 20px;"
                                            class="flex justify-content-center align-items-center ">
                                            {{record.userName!=null?record.userName.charAt(0):'A'}}</div>
                                        <div style="font-size: 14px;color: #000000;">
                                            {{record.userName!=null?record.userName:'NA'}}</div>
                                    </div>

                                </td>
                                <td style="color: #6D6D6D;">{{ record.employeeId }}</td>

                                <!-- if checkin completed -->
                                <td *ngIf="record.checkIn && (record.present==true && record.absent==false)">
                                    <div class="flex gap-4" style="align-items: center; justify-content: start;">
                                        <!-- isPresent -->
                                        <button class="" style="width: 95px;height: 31px;border-radius: 4px;background-color: #B0B0B0;border: 1px #B0B0B0;font-size: 14px;color: #FFFFFF; background-color: green;
                                        border-color: green;
                                        color: #FFFFFF;cursor: not-allowed;" [disabled]="true"
                                            title="Already Marked Attendance For the Day"
                                            (click)="presentData('present',record)">Present</button>

                                        <button 
                                            style="cursor: not-allowed;width: 95px;height: 31px;border-radius: 4px;color: #FFFFFF;font-size: 14px;background-color: grey;"
                                            [disabled]="true" title="Already Marked Attendance For the Day"
                                            (click)="presentData('absent',record)">Absent</button>
                                    </div>
                                </td>



                                <td *ngIf="record.checkIn && (record.present==false && record.absent==true)">
                                    <div class="flex gap-4" style="align-items: center; justify-content: start;">
                                        <!-- isPresent -->
                                        <button class="" style="width: 95px;height: 31px;border-radius: 4px;background-color: #B0B0B0;border: 1px #B0B0B0;font-size: 14px;color: #FFFFFF; background-color: grey;
                                        border-color: green;
                                        color: #FFFFFF;cursor: not-allowed;" [disabled]="true"
                                            title="Already Marked Attendance For the Day"
                                            (click)="presentData('present',record)">Present</button>

                                        <button 
                                            style="cursor: not-allowed;width: 95px;height: 31px;border-radius: 4px;background-color: red;color: #FFFFFF;font-size: 14px;"
                                            [disabled]="true" title="Already Marked Attendance For the Day"
                                            (click)="presentData('absent',record)">Absent</button>
                                    </div>
                                </td>
                                <!-- if checkin not completed -->
                                <td *ngIf="!record.checkIn">
                                    <div class="flex gap-4" style="align-items: center; justify-content: start;">
                                        <button *ngIf="!record.present"
                                            style="width: 95px;height: 31px;border-radius: 4px;background-color: #B0B0B0;border: 1px #B0B0B0;font-size: 14px;color: #FFFFFF;"
                                            [disabled]="record.present"
                                            (click)="presentData('present',record)">Present</button>
                                        <!-- isPresent -->
                                        <button *ngIf="record.present" class="" style="width: 95px;height: 31px;border-radius: 4px;background-color: #B0B0B0;border: 1px #B0B0B0;font-size: 14px;color: #FFFFFF; background-color: green;
                                        border-color: green;
                                        color: #FFFFFF;" [disabled]="record.present"
                                            (click)="presentData('present',record)">Present</button>




                                        <button *ngIf="!record.absent"
                                            style="width: 95px;height: 31px;border-radius: 4px;color: #6D6D6D;font-size: 14px;"
                                            [disabled]="record.absent"
                                            (click)="presentData('absent',record)">Absent</button>



                                        <button *ngIf="record.absent"
                                            style="width: 95px;height: 31px;border-radius: 4px;background-color: red;color: #FFFFFF;font-size: 14px;"
                                            [disabled]="record.absent"
                                            (click)="presentData('absent',record)">Absent</button>
                                    </div>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="footer">
                            <div class="flex justify-content-end w-fit mr-8 "
                                style="background-color: #92278F;margin-top: 28px;float: inline-end;">
                                <button class=""
                                    style="border-radius: 4px;width: 184px;height: 39px;background-color: #92278F;color:#FFFFFF;border: 1px #92278F;float: right;"
                                    (click)="finalSweeperAttendenceSubmit()"> Submit</button>
                            </div>
                        </ng-template>
                    </p-table>

                </div>
            </div>
        </div>
    </div>

</div>